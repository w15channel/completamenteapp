<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Harmonia Diária - WR TERAPIA</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

<style>
body{
font-family:'Inter',sans-serif;
background:linear-gradient(135deg,#f0f9ff 0%,#e0f2fe 100%);
min-height:100vh;
color:#334155;
margin:0;
}

.glass-card{
background:rgba(255,255,255,0.9);
backdrop-filter:blur(12px);
border-radius:1.5rem;
box-shadow:0 8px 32px rgba(31,38,135,0.05);
}

.tab-content{display:none}
.tab-content.active{display:block}

.message{
max-width:85%;
padding:12px 16px;
border-radius:1.2rem;
margin-bottom:10px;
font-size:0.95rem;
}

.user{
background:#0ea5e9;
color:white;
margin-left:auto;
}

.therapist{
background:white;
}

</style>
</head>

<body>

<header class="p-4 text-center bg-white shadow">
<h1 class="text-xl font-bold text-sky-700">Harmonia Diária</h1>
<p class="text-xs text-sky-500">WR TERAPIA</p>
</header>

<main class="max-w-md mx-auto p-4">

<!-- HOME -->
<section id="home" class="tab-content active">
<div class="glass-card p-6">
<h2 class="text-lg font-bold mb-4">Menu</h2>

<div class="grid grid-cols-2 gap-3">

<button onclick="showTab('chat')" class="p-4 bg-white rounded-xl shadow">
Conversar
</button>

<button onclick="showTab('hope')" class="p-4 bg-white rounded-xl shadow">
Caixinha IA
</button>

<button onclick="showTab('mural')" class="p-4 bg-white rounded-xl shadow">
Mural
</button>

<button onclick="showTab('alivio')" class="p-4 bg-white rounded-xl shadow">
Espaço do Alívio
</button>

</div>
</div>
</section>

<!-- CHAT -->
<section id="chat" class="tab-content">
<div class="glass-card p-4">

<div id="messages"></div>

<input id="chatInput" class="w-full border rounded p-2 mt-3" placeholder="Digite..." />

<button onclick="sendMsg()" class="mt-2 w-full bg-sky-500 text-white p-2 rounded">
Enviar
</button>

<button onclick="showTab('home')" class="mt-2 text-xs">Voltar</button>
</div>
</section>

<!-- HOPE IA -->
<section id="hope" class="tab-content">
<div class="glass-card p-6 text-center">

<img id="hopeImg" class="rounded-xl mb-4"/>

<p id="hopeTxt" class="italic mb-4"></p>

<button onclick="gerarEsperanca()" class="bg-amber-500 text-white px-4 py-2 rounded">
Gerar
</button>

<button onclick="showTab('home')" class="block mt-3 text-xs">
Voltar
</button>

</div>
</section>

<!-- MURAL -->
<section id="mural" class="tab-content">
<div class="glass-card p-5">

<textarea id="muralInput" class="w-full border rounded p-3" placeholder="Deixe uma mensagem..."></textarea>

<button onclick="postMural()" class="w-full bg-green-500 text-white p-2 rounded mt-2">
Publicar
</button>

<div id="muralList" class="mt-4"></div>

<button onclick="showTab('home')" class="mt-3 text-xs">
Voltar
</button>

</div>
</section>

<!-- ALIVIO -->
<section id="alivio" class="tab-content">
<div class="glass-card p-5">

<p class="mb-3 text-sm">
Procure um local confortável.
Ajuste sua postura.
Respire lentamente.

Imagine histórias agradáveis,
ambientes seguros e tranquilos.
Permita que o som da chuva
acalma sua mente.
</p>

<div class="aspect-video">
<iframe width="100%" height="100%"
src="https://www.youtube.com/embed/sF80I-TQiW0"
allowfullscreen></iframe>
</div>

<button onclick="showTab('home')" class="mt-3 text-xs">
Voltar
</button>

</div>
</section>

</main>

<script>

/*************** COLE SUA CHAVE AQUI ***************/
const GROQ_API_KEY = "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";
        const GEMINI_API_KEY = "AIzaSyDeJ4tLe98pPnfRXRoWTsGM5uc_HAlhsnE";
/**************************************************/

function showTab(id){
document.querySelectorAll('.tab-content')
.forEach(t=>t.classList.remove('active'));

document.getElementById(id).classList.add('active');
}

/*************** CHAT ****************/

let history=[];

async function sendMsg(){
const input=document.getElementById("chatInput");
const txt=input.value;

if(!txt)return;

addMsg(txt,"user");
input.value="";

history.push({role:"user",content:txt});

const res=await fetch("https://api.groq.com/openai/v1/chat/completions",{
method:"POST",
headers:{
Authorization:`Bearer ${GROQ_API_KEY}`,
"Content-Type":"application/json"
},
body:JSON.stringify({
model:"llama-3.3-70b-versatile",
messages:history
})
});

const data=await res.json();
const reply=data.choices[0].message.content;

addMsg(reply,"therapist");
history.push({role:"assistant",content:reply});
}

function addMsg(t,c){
const div=document.createElement("div");
div.className="message "+c;
div.innerText=t;
document.getElementById("messages").appendChild(div);
}

/*************** CAIXINHA ****************/

async function gerarEsperanca(){

const img=`https://source.unsplash.com/600x400/?peace,nature&${Math.random()}`;
document.getElementById("hopeImg").src=img;

const res=await fetch("https://api.groq.com/openai/v1/chat/completions",{
method:"POST",
headers:{
Authorization:`Bearer ${GROQ_API_KEY}`,
"Content-Type":"application/json"
},
body:JSON.stringify({
model:"llama-3.3-70b-versatile",
messages:[
{role:"system",content:"Escreva uma mensagem curta de regulação emocional."}
]
})
});

const data=await res.json();
document.getElementById("hopeTxt").innerText =
data.choices[0].message.content;

}

/*************** MURAL ****************/

function postMural(){
const txt=document.getElementById("muralInput").value;
if(!txt)return;

const arr=JSON.parse(localStorage.getItem("mural")||"[]");
arr.unshift(txt);
localStorage.setItem("mural",JSON.stringify(arr));
renderMural();
}

function renderMural(){
const arr=JSON.parse(localStorage.getItem("mural")||"[]");
document.getElementById("muralList").innerHTML=
arr.map(x=>`<div class="bg-white p-2 rounded mb-2">${x}</div>`).join("");
}

renderMural();

</script>

</body>
</html>
